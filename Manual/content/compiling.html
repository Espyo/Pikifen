<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  
  <title>Compiling - Pikifen manual</title>
  <meta name="description" content="The Pikifen user manual">
  
  <link rel="stylesheet" href="../data/style.css">
  <script src="../data/script.js"></script>
</head>

<body onload="make_toc();">
  <iframe id="header-frame" src="header.html"></iframe>
  
  <div id="content">
    
    <h1>Compiling</h1>
    
    <p>This page will explain how to compile the engine from its source code. If you have downloaded the zip file with the engine already built, in an <code>.exe</code>, then you don't need to do any of this in order to play or make content!</p>
    
    <p>To begin, make sure you have downloaded the engine's source code, and you have a C++ compiler.</p>
    
    <h2 id="windows">Windows</h2>
    
    <h3 id="windows-vs-2019">Visual Studio 2019</h3>
    
    <ol>
      <li>Open the VS2019 .sln file with Visual Studio 2019.</li>
      <li>
        Compile. If you get any errors, try the following troubleshooting tips:
        <ul>
          <li>
            If you get <code>'min': identifier not found</code> (or <code>'max'</code>):
            <ul>
              <li>At the top of the file with the error add, near the other includes, <code>#include &lt;algorithm&gt;</code>. (I try to fix these errors for Windows builds, but I don't do it often, so bear with me!)</li>
            </ul>
          </li>
          <li>
            If you get tons of <code>expected an identifier</code> and <code>namespace __ has no member --</code> errors:
            <ul>
              <li>Try compiling with the Release x64 target.</li>
            </ul>
          </li>
          <li>
            If you get <code>Element &lt;LanguageStandard&gt; has an invalid value of "Default"</code>:
            <ul>
              <li>Project properties, C/C++, Language, C++ Language, C++ Language Standard: Set it to the highest available option, hopefully C++ 17.</li>
            </ul>
          </li>
          <li>
            If you don't have the Windows 10 SDK:
            <ul>
              <li>Right-click the solution, Retarget solution, and choose whatever the most recent option is.</li>
            </ul>
          </li>
          <li>It might only work if, during Visual Studio's installation, you've included <code>MSVC v142 - VS 2019 C++ x64/x86 Build Tools</code> and <code>Windows 10 SDK</code>.</li>
        </ul>
      </li>
    </ol>
    
    <h3 id="windows-vs-other">Other version of Visual Studio</h3>
    
    <p>Follow the instructions for <a href="#vs2019">Visual Studio 2019</a>, but go to the project properties, General, Platform Toolset, and set it to whatever you have.</p>
    
    <h2 id="linux">Linux</h2>
    
    <h3 id="linux-g++">g++ or Clang</h3>
    
    <ol>
      <li>Install Allegro 5.2 on your system using the instructions <a href="https://github.com/liballeg/allegro_wiki/wiki/Quickstart">here</a>.</li>
      <li>On a terminal, go to the engine's root folder and write <code>make -f Source/gnu_make/makefile</code>.</li>
    </ol>
    
    <ul>
      <li>If you get linker errors, edit the <code>makefile</code> file and follow the instructions. Write <code>make clean -f Source/gnu_make/makefile</code> and then build it once more.</li>
      <li>If you prefer to use Clang, edit the <code>makefile</code> file and follow the instructions. Write <code>make clean -f Source/gnu_make/makefile</code> and then build it once more.</li>
      <li>If you prefer to compile with Allegro 5.0.10 instead, edit the <code>makefile</code> file and add a <code>.0</code> after every <code>5</code> in the <code>LDFLAGS</code> line.
    </ul>
    
    <h3 id="linux-ide">IDE</h3>
    
    <ul>
      <li>If you want to use Codelite, use the project in the <code>Source/codelite</code> folder.</li>
      <li>
        If you want to use Visual Studio Code:
        <ol>
          <li>
            Create a <code>.vscode</code> folder in the engine's root folder.
            <ul>
              <li>Note that you may need to enable an option on your file explorer to allow you to see hidden files and folders, since <code>.vscode</code> is likely to end up being a hidden folder.</li>
              <li>If you can create the folder easily through your file explorer, or command line, do so.</li>
              <li>If you can't create it easily, open Visual Studio Code, go to File > Open Folder..., pick the engine's root folder, go to File > Preferences > Settings, and change any of the default options. The folder should now be created.</li>
            </ul>
          </li>
          <li>Go to <code>Source/vs_code</code>, copy everything there, and paste it in your <code>.vscode</code> folder.</li>
        </ol>
      </li>
    </ul>
    
    <h2 id="mac">Mac OS</h2>
    
    <h3 id="mac-g++">g++ or Clang</h3>
    
    <p>Follow the instructions for <a href="#linux-g++">Linux</a>.</p>
    
    <h3 id="mac-ide">IDE</h3>
    
    <ul>
      <li>If you want to use Visual Studio Code, follow the instructions for <a href="linux-ide">Linux</a>.</li>
    </ul>
    
    <h2 id="notes">Notes</h2>
    
    <p>Note that I mainly develop on Linux, so it's not unusual for the Visual Studio projects to have missing files or some compilation errors. If you get errors:</p>
    <ul>
      <li>Try adding any missing <code>.h</code> and <code>.cpp</code> files that are not in the project's files.</li>
      <li>Try adding <code>#include &lt;algorithm&gt;</code> to the top of any files that complain about <code>min()</code> or <code>max()</code> not existing.</li>
      <li>Try casting to <code>float</code> or <code>double</code> the parameters used in calls to <code>min()</code> or <code>max()</code>, if you get errors about unsuitable function calls.</li>
    </ul>
    
  </div>
</body>

</html>
