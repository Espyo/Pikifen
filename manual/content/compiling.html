<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  
  <title>Pikifen manual</title>
  <meta name="description" content="The Pikifen user manual">
  
  <link rel="stylesheet" href="../data/style.css">
  <script src="../data/script.js"></script>
  <link rel="icon" href="../../game_data/base/graphics/gui/icon.png" />
</head>

<body onload="setup('Compiling');">
  <div id="page-content">
    
    <p>This page will explain how to compile the engine from its source code. If you have downloaded the zip file with the engine already built, in an <code>.exe</code>, then you don't need to do any of this in order to play or make content!</p>
    
    <p>To begin, make sure you have downloaded <a href="https://github.com/Espyo/Pikifen">the engine's source code</a>, and you have a C++ compiler.</p>
    
    <h2 id="windows">Windows</h2>
	
    <p>Note that I mainly develop on Linux, so it's not unusual for the Visual Studio projects to have missing files or some compilation errors.</p>

    <h3 id="windows-vs-2022">Visual Studio 2022</h3>

    <ol>
      <li>Open the VS2022 .sln file with Visual Studio 2022.</li>
      <li>
        Compile. If you get any errors, try the following troubleshooting tips:
        <ul>
          <li>
            If you get <code>'min': identifier not found</code> (or <code>'max'</code>):
            <ul>
              <li>At the top of the file with the error add, near the other includes, <code>#include &lt;algorithm&gt;</code>. (I try to fix these errors for Windows builds, but I don't do it often, so bear with me!)</li>
              <li>Try casting the parameters used in calls to <code>min()</code> or <code>max()</code> to <code>float</code> or <code>double</code>, if you get errors about unsuitable function calls.</li>
            </ul>
          </li>
          <li>
            If you get tons of <code>expected an identifier</code> and <code>namespace __ has no member --</code> errors:
            <ul>
              <li>Try compiling with the Release x64 target.</li>
            </ul>
          </li>
          <li>
            If you get <code>Element &lt;LanguageStandard&gt; has an invalid value of "Default"</code>:
            <ul>
              <li>Project properties, C/C++, Language, C++ Language, C++ Language Standard: Set it to the highest available option, hopefully C++ 17.</li>
            </ul>
          </li>
          <li>
            If you don't have the Windows 10 SDK:
            <ul>
              <li>Right-click the solution, Retarget solution, and choose whatever the most recent option is.</li>
            </ul>
          </li>
          <li>It might only work if, during Visual Studio's installation, you've included <code>MSVC v143 - VS 2022 C++ x64/x86 Build Tools</code> and <code>Windows 10 SDK</code>.</li>
        </ul>
      </li>
      <li>
        The engine should launch after compilation.
        <ul>
          <li>If you get a popup with <code>game_data folder not found!</code>:
            <ul>
              <li>In the project settings under debugging, change <code>Working Directory</code> to <code>../..</code>.</li>
            </ul>
          </li>
        </ul>
      </li>
    </ol>
    
    <h3 id="windows-vs-other">Other version of Visual Studio</h3>
    
    <p>Follow the instructions for <a href="#vs2022">Visual Studio 2022</a>, but go to the project properties, General, Platform Toolset, and set it to whatever you have.</p>

    <h3 id="github-actions">GitHub actions</h3>

    <p>You can also let <a href="https://github.com/Espyo/Pikifen">GitHub</a>, the website hosting the repository for the project's source code, do the work. If you have an account, you can use your own fork of the project and run the "Compile for Windows" action. This will generate an artifact which is basically the binary <code>pikifen.exe</code> file.</p>
    
    <h2 id="linux">Linux</h2>
    
    <h3 id="linux-g++">g++ or Clang</h3>
    
    <ol>
      <li>Install Allegro 5.2.5 or higher on your system using the instructions <a href="https://github.com/liballeg/allegro_wiki/wiki/Quickstart">here</a>.</li>
      <li>On a terminal, go to the engine's root folder and write <code>make -f source/gnu_make/makefile</code>.</li>
    </ol>
    
    <ul>
      <li>If you get linker errors, edit the <code>makefile</code> file and follow the instructions. Write <code>make clean -f source/gnu_make/makefile</code> and then build it once more.</li>
      <li>If you prefer to use Clang, edit the <code>makefile</code> file and follow the instructions. Write <code>make clean -f source/gnu_make/makefile</code> and then build it once more.</li>
    </ul>
    
    <h3 id="linux-ide">IDE</h3>
    
    <ul>
      <li>
        If you want to use Visual Studio Code:
        <ol>
          <li>
            Create a <code>.vscode</code> folder in the engine's root folder.
            <ul>
              <li>Note that you may need to enable an option on your file explorer to allow you to see hidden files and folders, since <code>.vscode</code> is likely to end up being a hidden folder.</li>
              <li>If you can create the folder easily through your file explorer, or command line, do so.</li>
              <li>If you can't create it easily, open Visual Studio Code, go to File > Open Folder..., pick the engine's root folder, go to File > Preferences > Settings, and change any of the default options. The folder should now be created.</li>
            </ul>
          </li>
          <li>Go to <code>source/vs_code</code>, copy everything there, and paste it in your <code>.vscode</code> folder.</li>
        </ol>
      </li>
    </ul>
    
    <h2 id="mac">Mac OS</h2>
    
    <h3 id="mac-g++">g++ or Clang</h3>
    
    <p>Follow the instructions for <a href="#linux-g++">Linux</a>.</p>
    
    <h3 id="mac-ide">IDE</h3>
    
    <ul>
      <li>If you want to use Visual Studio Code, follow the instructions for <a href="#linux-ide">Linux</a>.</li>
    </ul>

  </div>
</body>

</html>
